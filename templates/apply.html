<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Apply for a Job</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <header>
        <h1>Submit Your Application</h1>
    </header>
    <nav>
        <a href="/">Home</a>
        <a href="/search">Search Jobs</a>
    </nav>
    <main>
        <form id="applicationForm">
            <input type="hidden" id="job_id">
            <label>First Name: <input type="text" id="first_name" required></label><br>
            <label>Last Name: <input type="text" id="last_name" required></label><br>
            <label>Email: <input type="email" id="email" required></label><br>
            <label>Phone: <input type="text" id="phone"></label><br>
            <label>Address: <input type="text" id="address"></label><br>
            <label>Education: <input type="text" id="education"></label><br>
            <label>Experience (years): <input type="number" id="experience"></label><br>
            <button type="submit">Submit Application</button>
        </form>
        <p id="result"></p>
    </main>

    <script>
    // Prefill job ID if passed in URL
    const urlParams = new URLSearchParams(window.location.search);
    const jobId = urlParams.get("job_id");
    if (jobId) document.getElementById("job_id").value = jobId;

    document.getElementById("applicationForm").addEventListener("submit", async function(e) {
        e.preventDefault();
        const data = {
            job_id: document.getElementById("job_id").value,
            first_name: document.getElementById("first_name").value,
            last_name: document.getElementById("last_name").value,
            email: document.getElementById("email").value,
            phone: document.getElementById("phone").value,
            address: document.getElementById("address").value,
            education: document.getElementById("education").value,
            experience: document.getElementById("experience").value
        };

        const response = await fetch("/applications/submit", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        document.getElementById("result").textContent = result.message;
    });
    </script>
</body>
</html>
